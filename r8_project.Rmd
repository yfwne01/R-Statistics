---
title: "project"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
#packages
library(randomForest) #Random forest for classification and regression
library(lattice)
library(ggplot2)

library(caret) #partition the training and testing data
library(rpart)# Regressive Partitioning and Regression trees
library(rpart.plot)# Decision Tree plot

#setting the overall seed for reproduceability
set.seed(1234)

#load the data and clean up
trainUrl <- "http://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv"
testUrl <- "http://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv"
training <- read.csv(url(trainUrl), na.strings=c("NA","#DIV/0!",""))
testing <- read.csv(url(testUrl), na.strings=c("NA","#DIV/0!",""))

```



```{r}
#Cleaning the data
myDataNZV <- nearZeroVar(TrainingSet, saveMetrics=TRUE)
dim(myTraining)
TrainingSet <- TrainingSet[c(-1)]

```

```{r}
#partition the data so that 75% of the training dataset into training and the remaining 25% to testing
inTrain <- createDataPartition(y=training$classe, p=0.75, list=FALSE)
TrainingSet <- training[inTrain, ]
TestingSet <- training[-inTrain, ]

dim(TrainingSet)
dim(TestingSet)

```

```{r}
#use decision tree for prediction
modfit1 <-rpart(classe ~ ., data=TrainingSet, method="class")
prediction1 <- predict(modfit1, TestingSet, type = "class")

#plot the decision tree
rpart.plot(modfit1, main="Classification Tree", extra=102, under=TRUE, faclen=0)

confusionMatrix(TestingSet$classe, prediction1)$overall['Accuracy']


```

```{r}
#use random forest for predition
rfmodel <- suppressMessages(train(classe~., data=TrainingSet, method="rf"))
rfresult <- predict(rfmodel, TestingSet)
confusionMatrix(TestingSet$class, rfresult)$overall['Accuracy']


#conclusion
#Both Random Forest algorithm and Decision Trees peform well. Accuracy for Random Forest model was 0.99 (95% CI: (0.993, 0.997)) compared to Decision Tree model with 0..99(95% CI: (0.727, 0.752)). The Random Forests model is choosen. The expected out-of-sample error is estimated at 0.005, or 0.5%.
```



